# Video Upscaler 使用说明书

## 📖 目录

1. [快速开始](#快速开始)
2. [安装指南](#安装指南)
3. [界面说明](#界面说明)
4. [使用教程](#使用教程)
5. [高级设置](#高级设置)
6. [常见问题](#常见问题)
7. [故障排除](#故障排除)

---

## 🚀 快速开始

### 三步开始处理视频

1. **添加视频**：拖放视频文件到程序窗口，或点击选择文件
2. **选择档位**：选择"流畅"/"标准"/"高清"预设
3. **开始处理**：点击"开始处理"按钮

---

## 💾 安装指南

### 系统要求

- **操作系统**: Windows 10/11 (64位)
- **显卡**: NVIDIA GeForce GTX 1060 或更高 (支持CUDA)
- **显存**: 至少 4GB
- **内存**: 至少 8GB
- **磁盘空间**: 至少 10GB 可用空间

### 安装步骤

1. 下载安装程序 `VideoUpscaler-Setup.exe`
2. 双击运行安装程序
3. 按照向导完成安装
4. 首次启动会自动下载AI模型（约100MB）

### 首次启动

首次运行时，程序会自动：
- 检查系统环境
- 下载必要的AI模型文件
- 创建配置文件

---

## 🖥️ 界面说明

### 主界面布局

```
┌─────────────────────────────────────────────────────────────┐
│  Video Upscaler - 视频高清修复                                │
├──────────────────────────────┬───────────────────────────────┤
│                              │                               │
│  导入视频                    │      预览区域                  │
│  ┌──────────────────────┐    │      ┌───────────────────┐    │
│  │ 拖放视频文件到这里    │    │      │   原视频预览       │    │
│  │ 或点击选择文件       │    │      └───────────────────┘    │
│  └──────────────────────┘    │      ┌───────────────────┐    │
│                              │      │   处理后预览       │    │
│  输出设置                    │      └───────────────────┘    │
│  ┌──────────────────────┐    │                               │
│  │ 画质档位: [标准v]     │    │                               │
│  │ ☑ 启用补帧           │    │                               │
│  │ 输出目录: [...]      │    │                               │
│  └──────────────────────┘    │                               │
│                              │                               │
│  任务队列                    │                               │
│  ┌──────────────────────┐    │                               │
│  │ 1. video1.mp4      │    │                               │
│  │ 2. video2.mp4      │    │                               │
│  └──────────────────────┘    │                               │
│                              │                               │
│  [开始处理]  [暂停]          │                               │
│  总进度: [████████░░] 80%    │                               │
├──────────────────────────────┴───────────────────────────────┤
│  日志: 正在处理 frame 1234/5678...                           │
└─────────────────────────────────────────────────────────────┘
```

### 功能区域说明

#### 1. 导入视频
- 支持拖放导入
- 支持点击选择多个文件
- 支持的视频格式：MP4, MKV, AVI, MOV, WMV, FLV, WEBM

#### 2. 输出设置

**画质档位**：
- **流畅**: 720p/1080p，显存需求 ~2GB，处理速度快
- **标准**: 1080p 60fps，显存需求 ~4GB，处理速度中等
- **高清**: 4K 60fps，显存需求 ~6GB，处理速度慢

**补帧选项**：
- 启用后 24fps → 60fps
- 需要额外显存和计算时间

#### 3. 任务队列
- 显示所有待处理视频
- 支持批量添加和删除
- 显示每个任务的进度

#### 4. 预览区域
- 原视频预览（抽帧）
- 处理后预览（可选）

---

## 📚 使用教程

### 教程 1：基础超分

**目标**: 将 480p 视频提升到 1080p

1. 启动 Video Upscaler
2. 拖放一个 MP4 视频到窗口
3. 选择"标准"档位
4. 取消勾选"启用补帧"
5. 点击"开始处理"
6. 等待处理完成，输出视频在同级目录

**预期时间**: 1分钟视频约 2-5 分钟

### 教程 2：超分 + 补帧

**目标**: 将 24fps 视频提升到 60fps 并超分

1. 添加视频到队列
2. 选择"标准"或"高清"档位
3. 勾选"启用补帧"
4. 点击"开始处理"
5. 观察进度条和日志

**预期时间**: 1分钟视频约 5-10 分钟

### 教程 3：批量处理

**目标**: 一次性处理多个视频

1. 拖放多个视频文件到窗口
2. 检查队列列表显示所有视频
3. 选择输出目录（可选）
4. 点击"开始处理"
5. 程序会依次处理每个视频

**注意**: 批量处理按顺序执行，不并行处理

### 教程 4：暂停和恢复

**场景**: 需要临时中断处理

1. 处理过程中点击"暂停"
2. 程序会在当前帧完成后暂停
3. 点击"开始处理"恢复
4. 或关闭程序，下次启动会继续处理

---

## ⚙️ 高级设置

### 配置文件位置

```
Windows: %APPDATA%\VideoUpscaler\config.json
```

### 可调参数

```json
{
  "performance": {
    "cpu_workers": 4,        // CPU工作线程数
    "gpu_memory_fraction": 0.8,  // GPU内存使用比例
    "tile_size": 512         // 超分tile大小
  },
  "output": {
    "default_codec": "h264_nvenc",  // 默认编码器
    "default_quality": 23     // 默认质量(CRF)
  },
  "ui": {
    "preview_enabled": true,  // 启用预览
    "theme": "auto"          // 主题: auto/light/dark
  }
}
```

### 命令行参数

```bash
# 启动并立即处理指定视频
VideoUpscaler.exe --input "video.mp4" --preset "高清" --output "output.mp4"

# 批量处理
VideoUpscaler.exe --batch "folder/*.mp4" --preset "标准"

# 显示帮助
VideoUpscaler.exe --help
```

---

## ❓ 常见问题

### Q1: 支持哪些视频格式？

**A**: 支持几乎所有常见格式：
- MP4, MKV, AVI, MOV, WMV
- FLV, WEBM, M4V, TS

输入格式会自动检测，输出格式固定为 MP4。

### Q2: 需要什么样的显卡？

**A**: 
- **最低**: GTX 1060 6GB 或 RTX 2060
- **推荐**: RTX 3060 或更高
- **必需**: NVIDIA 显卡（支持CUDA）

### Q3: 处理速度怎么样？

**A**: 参考速度（RTX 3060 12GB）：
- 流畅档：实时速率的 5-10 倍
- 标准档：实时速率的 2-5 倍
- 高清档：实时速率的 0.5-2 倍

### Q4: 为什么补帧后的视频看起来不自然？

**A**: 补帧可能在以下场景出现问题：
- 快速切换的镜头
- 包含文字/字幕的画面
- 高度压缩的视频

建议先测试短片段，确认效果后再处理完整视频。

### Q5: 可以处理竖屏视频吗？

**A**: 可以。程序会自动检测视频分辨率方向，保持原始比例。

### Q6: 处理会修改原视频吗？

**A**: 不会。程序始终输出到新文件，原视频保持不变。

### Q7: 如何获得最佳质量？

**A**: 
1. 使用高质量的原视频
2. 选择"高清"档位
3. 确保有足够的显存
4. 避免多次转码

### Q8: 程序崩溃了怎么办？

**A**: 
1. 检查显存是否足够
2. 尝试降低档位（如从高清改为标准）
3. 更新显卡驱动
4. 查看日志文件排查问题

---

## 🔧 故障排除

### 问题 1: 启动时提示 "FFmpeg 未检测到"

**原因**: 系统未安装 FFmpeg

**解决方案**:
1. 下载 FFmpeg: https://ffmpeg.org/download.html
2. 解压到系统路径
3. 添加 FFmpeg 到系统 PATH
4. 重新启动程序

### 问题 2: 模型下载失败

**原因**: 网络连接问题

**解决方案**:
1. 检查网络连接
2. 手动下载模型文件：
   ```bash
   python scripts/download_models.py
   ```
3. 将模型文件放入 `models/` 目录

### 问题 3: 处理时显存不足 (OOM)

**症状**: 程序报错 "CUDA out of memory"

**解决方案**:
1. 选择更低的档位（如从高清改为标准）
2. 减少补帧（禁用补帧选项）
3. 关闭其他占用显存的程序
4. 在配置文件中减小 tile_size

### 问题 4: 输出视频播放卡顿

**原因**: 可能是播放器不支持高分辨率/高帧率

**解决方案**:
1. 使用现代播放器（如 VLC, PotPlayer）
2. 降低档位重新处理
3. 检查硬盘读取速度

### 问题 5: 进度条卡住不动

**原因**: 可能是进程卡住或崩溃

**解决方案**:
1. 等待 1-2 分钟（可能在大文件处理中）
2. 点击"暂停"再"继续"
3. 关闭程序重新启动（支持断点续传）
4. 检查日志文件定位问题

### 问题 6: 补帧后出现画面撕裂

**原因**: 补帧算法在某些场景下失效

**解决方案**:
1. 禁用补帧选项
2. 选择不同的补帧算法
3. 预处理视频（去噪等）

### 问题 7: 安装程序无法运行

**原因**: Windows 安全设置或文件损坏

**解决方案**:
1. 右键安装程序 → 属性 → 解除锁定
2. 以管理员身份运行
3. 重新下载安装程序
4. 暂时关闭杀毒软件

---

## 📞 技术支持

### 获取帮助

- **GitHub Issues**: https://github.com/ch-1105/video-upscaler/issues
- **邮件支持**: support@example.com
- **QQ群**: 123456789

### 反馈问题

反馈问题时请提供：
1. 程序版本号
2. Windows 版本
3. 显卡型号和驱动版本
4. 错误信息或截图
5. 日志文件（`%APPDATA%\VideoUpscaler\logs\app.log`）

---

## 📄 许可证

Video Upscaler 使用 GPL-3.0 开源许可证。

---

**最后更新**: 2026年2月
